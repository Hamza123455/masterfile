<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Video Editor</title>
</head>
<body>
    <h2>Basic Video Trimmer</h2>
    
    <input type="file" id="videoInput" accept="video/*">
    <video id="videoPlayer" controls width="500"></video>
    
    <br>

    <label>Start Time (seconds):</label>
    <input type="number" id="startTime" value="0">

    <label>End Time (seconds):</label>
    <input type="number" id="endTime" value="10">

    <button onclick="trimVideo()">Trim Video</button>
    
    <p id="status"></p>

    <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.9.7/dist/ffmpeg.min.js"></script>
    <script>
        const videoInput = document.getElementById("videoInput");
        const videoPlayer = document.getElementById("videoPlayer");
        const statusText = document.getElementById("status");

        let selectedFile;

        videoInput.addEventListener("change", function(event) {
            selectedFile = event.target.files[0];
            if (selectedFile) {
                const url = URL.createObjectURL(selectedFile);
                videoPlayer.src = url;
            }
        });

        async function trimVideo() {
            if (!selectedFile) {
                alert("Please select a video first.");
                return;
            }

            const startTime = parseFloat(document.getElementById("startTime").value);
            const endTime = parseFloat(document.getElementById("endTime").value);

            if (startTime >= endTime) {
                alert("End time must be greater than start time.");
                return;
            }

            statusText.textContent = "Loading FFmpeg...";
            const { createFFmpeg, fetchFile } = FFmpeg;
            const ffmpeg = createFFmpeg({ log: true });

            await ffmpeg.load();
            statusText.textContent = "Processing...";

            ffmpeg.FS("writeFile", "input.mp4", await fetchFile(selectedFile));
            await ffmpeg.run(
                "-i", "input.mp4",
                "-ss", startTime.toString(),
                "-to", endTime.toString(),
                "-c", "copy",
                "output.mp4"
            );

            const data = ffmpeg.FS("readFile", "output.mp4");
            const videoBlob = new Blob([data.buffer], { type: "video/mp4" });
            const url = URL.createObjectURL(videoBlob);

            const a = document.createElement("a");
            a.href = url;
            a.download = "trimmed_video.mp4";
            a.click();

            statusText.textContent = "Trimmed video downloaded!";
        }
    </script>
</body>
</html>
